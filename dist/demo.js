"use strict";

var euk = _interopRequireWildcard(require("./eukleides.js"));

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

window.eukleides = euk;

window.run_demo = function () {
  var PI = Math.PI;
  Numbas.queueScript('base', [], function () {});
  Numbas.queueScript('demo', ['extensions/eukleides/eukleides.js'], function () {
    var s = window.s = new Numbas.jme.Scope([Numbas.jme.builtinScope, Numbas.extensions.eukleides.scope]);
    var examples = document.getElementById('examples');

    function show_diagram(script) {
      var article = document.createElement('article');
      var svg_diagram = s.evaluate(script);
      var svg = svg_diagram.value[0];
      article.appendChild(svg);
      var pre = document.createElement('pre');
      pre.textContent = script;
      article.appendChild(pre);
      examples.appendChild(article);
    }

    show_diagram("eukleides(\"Circle inscribed in a square\",let(\n  s,polygon(square())\n, a,isobarycenter(s)\n, c,circle(a,len(s[1]-s[0])/2)\n, [\n    s description(\"square\")\n  , c description(\"circle inscribed in square\")\n  ]\n))");
    show_diagram("\neukleides(\"A set diagram\",[\n([\npolygon(square(point(-6,-6),point(6,-6))),\ncircle(point(2,deg(30)),3)\n,circle(point(2,deg(150)),3)\n,circle(point(2,deg(270)),3)\n,point(5,deg(90)) text(\"1\")\n,point(0,0) text(\"2\")\n,point(3,deg(30)) text(\"3\")\n,point(5,deg(-45)) text(\"4\")\n,point(3,deg(240)) text(\"5\")\n,point(2,deg(210)) text(\"6\")\n,point(5,deg(215)) text(\"7\")\n,point(3,deg(300)) text(\"8\")\n,point(2,deg(90)) text(\"9\")\n,point(3,deg(150)) text(\"10\")\n,point(6,deg(45)) text(\"B\") bold\n,point(6,deg(135)) text(\"A\") bold\n,point(5.3,deg(-90)) text(\"C\") bold\n]) size(2)\n])");
    show_diagram("eukleides(\"Interactive plot of sine curve\",\n-2,-1.7,2*pi+1,2,\n[\nlet(\n  x,clamp(rx,0,2pi),\n  area,y*(1-cos(x)),\n  curve,polygon(map(point(x,sin(x)*y),x,0..x#0.2)+[point(x,sin(x)*y)]),\n  [\n    (point(0,y)..point(2*pi+0.2,y)) dashed gray description(\"Horizontal line showing amplitude of the curve\"),\n    (curve..point(x,0)) filled transparent description(\"Area under the curve\"),\n    curve open description(\"Plot of sin(x)\"),\n    (point(0,0)..point(2*pi+0.2,0)) arrow description(\"x axis\"),\n    point(pi,y) label(\"Area: \"+dpformat(area,2),deg(90)),\n    point(x,0) label(\"x = \"+dpformat(x,2),deg(sgn(y)*if(x>pi,90,-90))),\n    point(x,0) draggable() size(2) blue,\n    point(-0.5,y) label(\"y = \"+dpformat(y,2),deg(180)),\n    point(-0.5,y) draggable() size(2) blue\n  ]\n)\n],\n[\"y\":1,\"rx\":pi/2]\n)\n");
    show_diagram("\n  let(scale,3,eukleides(\"Angles in a triangle\",\n    -0.5,-0.8,2*scale+0.5,scale+0.2,\n    [\n    let(\n      a,point(0,0),\n      b,point(2*scale,0),\n      x,clamp(1/tan(radians(theta)),0,2),\n      c,point(x*scale,scale),\n      h,projection(c,line(a,b)),\n      theta2,degrees(angle_between(c-b,a-b)),\n      [\n        a..b..c,\n        (c..h) dashed transparent,\n        ((c..h)+vector(0.25,0)) arrows gray label(\"1.00\"),\n        ((a..h)-vector(0,0.25)) arrows gray label(dpformat(x,2),deg(-90)),\n        angle(b,a,c) if(90|precround(theta,0),right,simple) label(deg(precround(theta,0))),\n        angle(c,b,a) if(90|precround(theta2,0),right,simple) label(deg(precround(theta2,0))),\n        h draggable(),\n        c draggable()\n      ]\n    )\n    ],\n    [\"theta\":45]\n  ))\n");
    show_diagram("\neukleides(\"Parallel lines in a circle\",-3.5,-3.5,3.5,3.5,\n[let(\n   anb,180-2*ana\n  ,circ,circle(origin,3)\n  ,a,point(circ,deg(rot))\n  ,b,point(circ,deg(anb+rot))\n  ,c,point(circ,deg(130+rot))\n  ,o,origin\n  ,[\n    circ\n    ,origin..a\n    ,(a..b) simple\n    ,b..c\n    ,(o..b) dashed\n    ,(origin..c) simple\n    ,o label(\"O\",deg(rot-90)) italic\n    ,a label(\"A\",deg(rot)) italic\n    ,b label(\"B\",deg(anb+rot)) italic\n    ,c label(\"C\",deg(130+rot)) italic\n    ,angle(b,a,o) label(angle_between(b-a,o-a))\n    ,angle(o,b,a) label(angle_between(o-b,a-b))\n    ,angle(o,c,b) label(angle_between(o-c,b-c))\n    ,angle(b,o,c) label(angle_between(b-o,c-o))\n    ,a draggable(\"A\",[\"rot\"])\n    ,b draggable(\"B\",[\"ana\"])\n  ])\n],[\"ana\":50])\n");
    show_diagram("\neukleides(\"Bearings between A, B and C\",[\n  let(\n    ana, deg(heading_1)\n  , anb, deg(heading_2)\n  , a, origin\n  , b, point(4,deg(90)-ana)\n  , c, point(length_2,deg(90)-anb)+(b-a)\n  , m, (a+vector(0,1))\n  , n, (b+vector(0,1))\n  , p, (c+vector(0,1.5)) \n  , [\n      (a..b..c)\n    , (a..b) label(\"4\")\n    , (b..c) label(length_2+\"\")\n    , (a..c) label(\"x\",deg(180)) italic\n    , (a..m) arrow\n    , (b..n) arrow\n    , (c..p) arrow\n    , ([\n        a label(\"A\",deg(180))\n      , b label(\"B\")\n      , c label(\"C\",deg(-90))\n      , m label(\"M\",deg(90),0.1)\n      , n label(\"N\",deg(90),0.1)\n      , p label(\"P\",deg(90),0.1)\n      ]) italic\n    , angle(b,a,m) label(ana)\n    , angle(c,b,n) label(anb)\n    , angle(c,a,b) label(\"\u03B8\") italic\n    , angle(n,b,a) label(deg(180)-ana)\n    , angle(a,b,c) label(deg(180)+ana-anb)\n    , b draggable([\"heading_1\"])\n    , c draggable([\"heading_2\"])\n  ])\n],[\"heading_1\": 100, \"heading_2\": 200, \"length_2\": 5])\n");
    show_diagram("eukleides(\"Feuerbach's circle\",[\n    let([a,b,c],triangle(),\n        a',projection(a,line(b,c)),\n        b',projection(b,line(c,a)),\n        c',projection(c,line(a,b)),\n        a_0,midpoint(b..c),\n        b_0,midpoint(c..a),\n        c_0,midpoint(a..b),\n        \n        [\n            a label(\"A\",deg(-135)),\n            b label(\"B\",deg(-45)),\n            c label(\"C\",deg(90)),\n            a',b',c',\n            a' label(\"A'\",deg(45)),\n            b' label(\"B'\",deg(135)),\n            c' label(\"C'\",deg(-90)),\n            a_0,b_0,c_0,\n            a_0 label(\"A_0\",deg(30)),\n            b_0 label(\"B_0\",deg(150)),\n            c_0 label(\"C_0\",deg(-90)),\n            (a..b..c),\n            circle(a',b',c'),\n            ([a..a', b..b', c..c']) dashed\n        ]\n    )\n])");
    show_diagram("eukleides(\"Tangents to a circle\",[\n    let(\n        O,point(0,2),\n        C1,circle(O,2),\n        A,point(6.5,2),\n        C2,circle(O..A),\n        points,intersection(C1,C2),\n        [\n            line(A,points[0]) gray,\n            line(A,points[1]) gray,\n            C1,\n            C2 dashed gray,\n            O plus,\n            A\n        ]\n    )\n])");
    show_diagram("eukleides(\"An isosceles triangle\",\n    -1,-1,7,3,[\n    let(\n        t, isosceles(),\n        a,t[0],b,t[1],c,t[2],\n        H, projection(c,line(a,b)),\n        [\n            (a..b..c), \n            (c..h) dashed,\n            h,\n            angle(b,h,c) right,\n            angle(b,a,c) double,\n            angle(c,b,a) double,\n            (a..h) label(),\n            (b..h) label(),\n            (a..c) label() double,\n            (c..b) label() double\n        ]\n    )\n])");
    show_diagram("eukleides(\"Collinear points\",\n    -1,-1,8,5,[\n    let(\n        [a,b,c,d],square(),\n        [a,b,f],equilateral(a,b),\n        [c,b,g],equilateral(c,b),\n        [\n            line(f..g) dashed darkgray,\n            (a..b..c..d),\n            (a..b..f),\n            (c..b..g)\n        ]\n    )\n])");
    show_diagram("eukleides(\"Touching squares\",[\n    let(\n        [a,b,c,d],square(),\n        (a..b..c..d) hsl(0,0.5,0.9)\n    ),\n    let(\n        [a,b,c,d],square(point(1,1),point(3,2)),\n        (a..b..c..d) filled hsl(240,0.5,0.75)\n    ),\n    let(\n        [a,b,c,d],square(1),\n        (a..b..c..d) filled hsl(120,0.5,0.75)\n    )\n])");
    show_diagram("\neukleides(\"Mouse input and animation demo\",\n-2,-2,5,2,[\n  let(theta,argument(vector(mousex,mousey)),\n      circ,circle(origin,1),\n      a,point(circ,theta),\n      b,point(circ,theta+deg(120)),\n      c,point(circ,theta+deg(240)),\n      [a..b..c, circle(a,b,c), a label(\"Mouse\",theta)]\n  ),\n  let(\n    t, 5*time,\n    hours, t,\n    seconds, 60*t,\n    centre, vector(3,0),\n    O, origin+centre,\n    h1, point(0.5,deg(90-hours))+centre,\n    h2, point(0.7,deg(90-seconds))+centre,\n    [\n      circle(O,1),\n      O..h1,\n      O..h2\n    ]\n  )\n])\n");
    show_diagram("\neukleides(\"Variable speed animation\",-5,-1,5,5,\n[let(\na,point(xa,ya),\nb,point(xb,yb),\nv,b-a,\nd,len(v),\nt,mod(time,1/speed)*speed,\nc,a+t*(b-a),\n[\n([\n  point(-2,4.1)..point(-2,3.9),\n  point(-2,4)..point(2,4),\n  point(2,4.1)..point(2,3.9)\n]) gray,\npoint(-2,4) label(\"Speed\",deg(180)),\npoint(clamp(5*speed,1,5)-3,4) draggable() gray,\n(a..c) dotted arrow,\na draggable(),b draggable()\n]\n)],[\"xa\":-3,\"xb\":3,\"yb\":2,\"speed\":0.5])\n");
    show_diagram("\neukleides(\"Complete graph\",-2.5,-2.5,2.5,2.5,\n[\nlet(\nsides,round(min(15,360/an)),\nstep,360/sides,\npoints,map(point(2,deg(x)),x,0..360#step),\n[\n  map(point(2,deg(360/n)),n,2..15) gray,\n  points\n, map(a..b,[a,b],combinations(points,2))\n, point(2,deg(clamp(an,1,180))) draggable(\"P\")\n]\n)\n],[\"an\":45,\"step\":90])\n");
    show_diagram("eukleides(\"Different point types\",[\n    point(1,0),\n    point(2,0) disc,\n    point(1,1) box,\n    point(2,1) plus,\n    point(2,0) cross,\n    (point(1,0)..point(2,0)..point(2,1)..point(1,1)) filled red opacity(0.2)\n])");
    show_diagram("eukleides(\"Line marks\",[\n    (point(0,0)..point(3,3)) label() simple,\n    (point(2,0)..point(4,3)) label() double,\n    (point(4,0)..point(5,3)) label() triple\n])");
    show_diagram("eukleides(\"Angle marks\",[\n    let(a,point(1,0), b,point(0,0), c,point(1,1),\n       [a..b,b..c,angle(a,b,c)]\n    ),\n    let(a,point(2,0), b,point(1,0), c,point(2,1),\n       [a..b,b..c,angle(a,b,c) double]\n    ),\n    let(a,point(3,0), b,point(2,0), c,point(3,1),\n       [a..b,b..c,angle(a,b,c) triple]\n    ),\n    let(a,point(1,1), b,point(0,1), c,point(1,2),\n       [a..b,b..c,angle(a,b,c) dashed]\n    ),\n    let(a,point(2,1), b,point(1,1), c,point(2,2),\n       [a..b,b..c,angle(a,b,c) double dashed]\n    ),\n    let(a,point(3,1), b,point(2,1), c,point(3,2),\n       [a..b,b..c,angle(a,b,c) triple dashed]\n    ),\n    let(a,point(1,2), b,point(0,2), c,point(1,3),\n       [a..b,b..c,angle(a,b,c) dotted]\n    ),\n    let(a,point(2,2), b,point(1,2), c,point(2,3),\n       [a..b,b..c,angle(a,b,c) double dotted]\n    ),\n    let(a,point(3,2), b,point(2,2), c,point(3,3),\n       [a..b,b..c,angle(a,b,c) triple dotted]\n    ),\n    let(a,point(3,1), b,point(3,0), c,point(4,0),\n       [a..b,b..c,angle(a,b,c) right]\n    ),\n    let(a,point(3,2), b,point(3,1), c,point(4,1),\n       [a..b,b..c,angle(a,b,c) right dotted]\n    ),\n    let(a,point(5,0), b,point(4,0), c,point(5,1),\n       [a..b,b..c,angle(a,b,c) forth]\n    ),\n    let(a,point(5,1), b,point(4,1), c,point(5,2),\n       [a..b,b..c,angle(a,b,c) back]\n    )\n])");
    show_diagram("eukleides(\"Pretty much everything!\",[\n    point(0,2.5) disc label(\"A\",deg(90)), \n    point(1,2.5) dot, \n    point(2,2.5) cross, \n    point(3,2.5) box, \n    point(4,2.5) plus,\n    (point(0,0) .. point(2,3) .. point(4,0)) arrows,\n    (point(0,1) .. point(2,4) .. point(4,1)),\n    (point(0,-1) .. point(2,2) .. point(4,-1)) filled transparent,\n    let(l1,line(point(-5,2), point(3,4)),\n        l2,line(point(8,0),point(-2,10)),\n        [l1,l2,intersection(l1,l2) label(\"I\",deg(90))]\n    ),\n    let(p,projection(point(0,0),line(point(-5,2), point(3,4))),\n        [p, (point(0,0)..p) dashed]\n    ),\n    let(p,projection(point(0,2),line(point(-5,2), point(3,4)), line(point(0,0),point(1,1))),\n        [p, line(point(0,2),point(1,3)) dashed]\n    ),\n    (line(point(-5,2), point(3,4)) + vector(0,-1)) dashed blue,\n    (line(point(-5,2), point(3,4)) + vector(0,-2)) dotted,\n    point(0,0),\n    (line(point(0,0), point(3,2))) half,\n    (line(point(0,0), point(3,2))+vector(0,-0.5)) half back dotted red size(3),\n    circle(point(1,3),4),\n    circle(point(1,3),3) dotted,\n    circle(point(1,3),2) dashed size(2) yellow,\n    conic(point(2,2),point(3,3),1.5),\n    arc(conic(point(2,4), point(2,5), 0.2),rad(0),rad(pi)) green size(3),\n    arc(circle(point(0,0),2),rad(0),rad(pi/2)) hsla(240,0.8,0.8,0.5) size(5) arrow,\n    arc(circle(point(0,0),1),rad(0),rad(pi/2)) rgba(255,0,0,0.7) size(1) arrows,\n    let(l,line(point(0,0),point(5,1)),\n        p,polygon(5,point(3,0),1,rad(0)),\n        c,circle(point(5,0.5),1),\n        el,conic(point(7,1),point(7,1.5),0.7),\n        [\n            l,\n            p blue,\n            intersection(l,p) size(3),\n            c,\n            intersection(l,c) size(3),\n            el,\n            intersection(l,el) size(3)\n        ]\n    ),\n    let(\n        p1,polygon(5,point(-1,5),1,rad(0)),\n        p2,polygon(6,point(0,5),1,rad(0)),\n        c1,circle(point(1.5,5),1),\n        c2,circle(point(2.5,4.7),0.5),\n        [\n            p1,\n            p2,\n            list(intersection(p1,p2)),\n            c1,\n            c2,\n            list(intersection(c1,c2)) blue,\n            list(intersection(p2,c1))\n        ]\n    )\n])");
  });
};

