"use strict";

var euk = _interopRequireWildcard(require("./eukleides.js"));

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj.default = obj; return newObj; } }

window.eukleides = euk;

window.run_demo = function () {
  var PI = Math.PI;
  Numbas.queueScript('base', [], function () {});
  Numbas.queueScript('demo', ['extensions/eukleides/eukleides.js'], function () {
    var s = window.s = new Numbas.jme.Scope([Numbas.jme.builtinScope, Numbas.extensions.eukleides.scope]);
    var examples = document.getElementById('examples');

    function show_diagram(script) {
      var article = document.createElement('article');
      var svg_diagram = s.evaluate(script);
      var svg = svg_diagram.value[0];
      article.appendChild(svg);
      var pre = document.createElement('pre');
      pre.textContent = script;
      article.appendChild(pre);
      examples.appendChild(article);
    }

    show_diagram("eukleides(\"Circle inscribed in a square\",let(\n  w,1\n, s,polygon(square(w))\n, a,center(s)\n, c,circle(a,w/2)\n, [\n    s description(\"square\")\n  , c description(\"circle inscribed in square\")\n  ]\n))");
    show_diagram("\neukleides(\"A set diagram\",[\n([\npolygon(square(point(-6,-6),point(6,-6))),\ncircle(point(2,deg(30)),3)\n,circle(point(2,deg(150)),3)\n,circle(point(2,deg(270)),3)\n,point(5,deg(90)) text(\"1\")\n,point(0,0) text(\"2\")\n,point(3,deg(30)) text(\"3\")\n,point(5,deg(-45)) text(\"4\")\n,point(3,deg(240)) text(\"5\")\n,point(2,deg(210)) text(\"6\")\n,point(5,deg(215)) text(\"7\")\n,point(3,deg(300)) text(\"8\")\n,point(2,deg(90)) text(\"9\")\n,point(3,deg(150)) text(\"10\")\n,point(5.5,deg(45)) text(\"B\") bold\n,point(5.5,deg(135)) text(\"A\") bold\n,point(5.5,deg(-90)) text(\"C\") bold\n]) size(2)\n])");
    show_diagram("\n// based on https://donsteward.blogspot.com/2011/06/add-one-square.html\neukleides(\"Add one square to each shape so it has a line of symmetry\",[\n group(\n  map(point(p[0],p[1]),p,product(0..6,0..6))\n ,point(1,4) .. point(5,4) .. point(5,3) .. point(3,3) .. point(3,2) \n  .. point(5,2) .. point(5,1) .. point(2,1) .. point(2,3) .. point(1,3)\n )\n,group(\n  map(point(p[0],p[1]),p,product(0..6,0..6))\n ,point(1,2) .. point(1,4) .. point(3,4) .. point(3,3) .. point(4,3) .. point(4,1) .. point(3,1) .. point(3,2)\n )+vector(8,0)\n,group(\n  map(point(p[0],p[1]),p,product(0..6,0..6))\n ,point(1,4) .. point(4,4) .. point(4,1) .. point(3,1) .. point(3,3) .. point(1,3)\n )+vector(16,0)\n,group(\n  map(point(p[0],p[1]),p,product(0..6,0..6))\n ,point(2,1) .. point(2,3) .. point(4,3) .. point(4,4) .. point(5,4) .. point(5,5) .. point(6,5) .. point(6,2) .. point(5,2) .. point(5,1)\n )+vector(24,0)\n,group(\n  map(point(p[0],p[1]),p,product(0..6,0..6))\n ,point(1,2) .. point(1,4) .. point(2,4) .. point(2,5) .. point(3,5) .. point(3,3) .. point(2,3) .. point(2,2)\n ,point(6,0) label(\"(2)\"))+vector(0,-8)\n,group(\n  map(point(p[0],p[1]),p,product(0..6,0..6))\n ,point(2,2) .. point(2,4) .. point(3,4) .. point(3,5) .. point(4,5) .. point(4,4) .. point(5,4) .. point(5,3) .. point(4,3) .. point(4,1) .. point(3,1) .. point(3,2),point(6,0) label(\"(2)\")\n )+vector(8,-8)\n,group(\n  map(point(p[0],p[1]),p,product(0..6,0..6))\n ,point(1,2) .. point(1,3) .. point(2,3) .. point(2,5) .. point(3,5) .. point(3,3) .. point(5,3) .. point(5,2),point(6,0) label(\"(2)\")\n )+vector(16,-8)\n,group(\n  map(point(p[0],p[1]),p,product(0..6,0..6))\n ,point(1,1) .. point(1,5) .. point(2,5) .. point(2,4) ..point(4,4) .. point(4,3) .. point(5,3) ..point(5,1)\n )+vector(24,-8)\n,group(\n  map(point(p[0],p[1]),p,product(0..6,0..6))\n ,point(1,3) .. point(1,4) .. point(4,4) .. point(4,2) .. point(3,2) .. point(3,3),point(6,0) label(\"(4)\")\n )+vector(0,-16)\n,group(\n  map(point(p[0],p[1]),p,product(0..6,0..6))\n ,point(1,1) .. point(1,3) .. point(3,3) .. point(3,4) .. point(4,4) .. point(4,1),point(6,0) label(\"(3)\")\n )+vector(8,-16)\n,group(\n  map(point(p[0],p[1]),p,product(0..6,0..6))\n ,point(1,2) .. point(1,4) .. point(2,4) .. point(2,5) .. point(3,5) .. point(3,4) .. point(4,4) .. point(4,2),point(6,0) label(\"(4)\")\n )+vector(16,-16)\n,group(\n  map(point(p[0],p[1]),p,product(0..6,0..6))\n ,point(1,2) .. point(1,4) .. point(3,4) .. point(3,3) .. point(4,3) .. point(4,2),point(6,0) label(\"(4)\")\n )+vector(24,-16)\n,point(0,-1) label(\"add an extra square so that the shape has at least one line of symmetry the (number) is the number of solutions\",deg(0),0.001) size(1.8)\n,point(0,-9) label(\"to give the overall shape a line of symmetry, try to find all possible positions for the one extra square for these:\",deg(0),0.001) size(1.8)\n]*size(2))\n");
    show_diagram("\n// based on http://pythagoreantriples.blogspot.com/2013/04/finding-length-in-pt-traingle.html\neukleides(\"\",let(\n [a,x,y,z],rectangle(30,24)\n,b,y-vector(12,0)\n,v,b-x\n,c,intersection(perpendicular(line(x,b),a),line(x,b))\n,[\n  a..x\n ,y..x label(24)\n ,b..y label(7)\n ,z..b label(18)\n ,x..c label(7)\n ,z..a\n ,angle(a,z,y) right\n ,angle(z,y,x) right\n ,x..b\n ,a label(\"A\",deg(-135))\n ,c label(\"C\",argument(c-a))\n ,a..c..b filled color3\n ,a..c..b\n ,angle(b,c,a) right\n ] * size(8)\n))\n");
    show_diagram("eukleides(\"Interactive plot of sine curve\",\n-2,-1.7,2*pi+1,2,\n[\nlet(\n  x,clamp(rx,0,2pi),\n  area,y*(1-cos(x)),\n  curve,polygon(map(point(x,sin(x)*y),x,0..x#0.2)+[point(x,sin(x)*y)]),\n  [\n    (point(0,y)..point(2*pi+0.2,y)) dashed gray description(\"Horizontal line showing amplitude of the curve\"),\n    (curve..point(x,0)) filled transparent description(\"Area under the curve\"),\n    curve open description(\"Plot of sin(x)\"),\n    (point(0,0)..point(2*pi+0.2,0)) arrow description(\"x axis\"),\n    point(pi,y) label(\"Area: \"+dpformat(area,2),deg(90)),\n    point(x,0) label(\"x = \"+dpformat(x,2),deg(sgn(y)*if(x>pi,90,-90))),\n    point(x,0) draggable() size(2),\n    point(-0.5,y) label(\"y = \"+dpformat(y,2),deg(180)),\n    point(-0.5,y) draggable() size(2)\n  ]\n)\n],\n[\"y\":1,\"rx\":pi/2]\n)\n");
    show_diagram("\n  let(scale,3,eukleides(\"Angles in a triangle\",\n    -0.5,-0.8,2*scale+0.5,scale+0.2,\n    [\n    let(\n      a,point(0,0),\n      b,point(2*scale,0),\n      x,clamp(1/tan(radians(theta)),0,2),\n      c,point(x*scale,scale),\n      h,projection(c,line(a,b)),\n      theta2,degrees(angle_between(c-b,a-b)),\n      [\n        a..b..c,\n        (c..h) dashed transparent,\n        ((c..h)+vector(0.25,0)) arrows gray label(\"1.00\"),\n        ((a..h)-vector(0,0.25)) arrows gray label(dpformat(x,2),deg(-90)),\n        angle(b,a,c) if(90|precround(theta,0),right,simple) label(deg(precround(theta,0))),\n        angle(c,b,a) if(90|precround(theta2,0),right,simple) label(deg(precround(theta2,0))),\n        h draggable(),\n        c draggable()\n      ]\n    )\n    ],\n    [\"theta\":45]\n  ))\n");
    show_diagram("\neukleides(\"Parallel lines in a circle\",-3.5,-3.5,3.5,3.5,\n[let(\n   anb,180-2*ana\n  ,circ,circle(origin,3)\n  ,a,point(circ,deg(rot))\n  ,b,point(circ,deg(anb+rot))\n  ,c,point(circ,deg(130+rot))\n  ,o,origin\n  ,[\n    circ\n    ,origin..a\n    ,(a..b) simple\n    ,b..c\n    ,(o..b) dashed\n    ,(origin..c) simple\n    ,o label(\"O\",deg(rot-90)) italic\n    ,a label(\"A\",deg(rot)) italic\n    ,b label(\"B\",deg(anb+rot)) italic\n    ,c label(\"C\",deg(130+rot)) italic\n    ,angle(b,a,o) label(angle_between(b-a,o-a))\n    ,angle(o,b,a) label(angle_between(o-b,a-b))\n    ,angle(o,c,b) label(angle_between(o-c,b-c))\n    ,angle(b,o,c) label(angle_between(b-o,c-o))\n    ,a draggable(\"A\",[\"rot\"])\n    ,b draggable(\"B\",[\"ana\"])\n  ])\n],[\"ana\":50])\n");
    show_diagram("\neukleides(\"Bearings between A, B and C\",[\n  let(\n    ana, deg(heading_1)\n  , anb, deg(heading_2)\n  , a, origin\n  , b, point(4,deg(90)-ana)\n  , c, point(length_2,deg(90)-anb)+(b-a)\n  , m, (a+vector(0,1))\n  , n, (b+vector(0,1))\n  , p, (c+vector(0,1.5)) \n  , [\n      (a..b..c)\n    , (a..b) label(\"4\")\n    , (b..c) label(length_2+\"\")\n    , (a..c) label(\"x\",deg(180)) italic\n    , (a..m) arrow\n    , (b..n) arrow\n    , (c..p) arrow\n    , ([\n        a label(\"A\",deg(180))\n      , b label(\"B\")\n      , c label(\"C\",deg(-90))\n      , m label(\"M\",deg(90),0.1)\n      , n label(\"N\",deg(90),0.1)\n      , p label(\"P\",deg(90),0.1)\n      ]) italic\n    , angle(b,a,m) label(ana)\n    , angle(c,b,n) label(anb)\n    , angle(c,a,b) label(\"\u03B8\") italic\n    , angle(n,b,a) label(deg(180)-ana)\n    , angle(a,b,c) label(deg(180)+ana-anb)\n    , b draggable([\"heading_1\"])\n    , c draggable([\"heading_2\"])\n  ])\n],[\"heading_1\": 100, \"heading_2\": 200, \"length_2\": 5])\n");
    show_diagram("eukleides(\"Feuerbach's circle\",[\n    let([a,b,c],triangle(),\n        a',projection(a,line(b,c)),\n        b',projection(b,line(c,a)),\n        c',projection(c,line(a,b)),\n        a_0,midpoint(b..c),\n        b_0,midpoint(c..a),\n        c_0,midpoint(a..b),\n        \n        [\n            a label(\"A\",deg(-135)),\n            b label(\"B\",deg(-45)),\n            c label(\"C\",deg(90)),\n            a',b',c',\n            a' label(\"A'\",deg(45)),\n            b' label(\"B'\",deg(135)),\n            c' label(\"C'\",deg(-90)),\n            a_0,b_0,c_0,\n            a_0 label(\"A_0\",deg(30)),\n            b_0 label(\"B_0\",deg(150)),\n            c_0 label(\"C_0\",deg(-90)),\n            (a..b..c),\n            circle(a',b',c'),\n            ([a..a', b..b', c..c']) dashed\n        ]\n    )\n])");
    show_diagram("eukleides(\"Tangents to a circle\",[\n    let(\n        O,point(0,2),\n        C1,circle(O,2),\n        A,point(6.5,2),\n        C2,circle(O..A),\n        points,intersection(C1,C2),\n        [\n            line(A,points[0]) gray,\n            line(A,points[1]) gray,\n            C1,\n            C2 dashed gray,\n            O plus,\n            A\n        ]\n    )\n])");
    show_diagram("eukleides(\"An isosceles triangle\",\n    -1,-1,7,3,[\n    let(\n        t, isosceles(),\n        a,t[0],b,t[1],c,t[2],\n        H, projection(c,line(a,b)),\n        [\n            (a..b..c), \n            (c..h) dashed,\n            h,\n            angle(b,h,c) right,\n            angle(b,a,c) double,\n            angle(c,b,a) double,\n            (a..h) label(),\n            (b..h) label(),\n            (a..c) label() double,\n            (c..b) label() double\n        ]\n    )\n])");
    show_diagram("eukleides(\"Collinear points\",\n    -1,-1,8,5,[\n    let(\n        [a,b,c,d],square(),\n        [a,b,f],equilateral(a,b),\n        [c,b,g],equilateral(c,b),\n        [\n            line(f..g) dashed darkgray,\n            (a..b..c..d),\n            (a..b..f),\n            (c..b..g)\n        ]\n    )\n])");
    show_diagram("eukleides(\"Touching squares\",[\n    let(\n        [a,b,c,d],square(),\n        (a..b..c..d) lightgray\n    ),\n    let(\n        [a,b,c,d],square(point(1,1),point(3,2)),\n        (a..b..c..d) filled color2\n    ),\n    let(\n        [a,b,c,d],square(1),\n        (a..b..c..d) filled color3\n    )\n])");
    show_diagram("eukleides(\"A bar chart in a selection of colour schemes\",\nlet(schemes,qualitative_color_schemes(3),\nmap(\nlet(\n  w, 2\n, origin, point(0,12sn)\n, [c1,c2,c3],schemes[sn]\n, gap, 0.5\n, biggap, 2\n, cw, 3*w+2*gap+biggap\n, data,[\n    [3,4,1,2010]\n  , [5,6,6,2011]\n  , [2,8,4,2012]\n  , [7,1,9,2013]\n  ]\n, style_a, filled dotted c1\n, style_b, filled dashed c2\n, style_c, filled c3\n, [\n    map(\n      let(\n        [name,style,j],d\n      , o, origin+vector(-biggap-gap,5-1.5j)\n      , [\n          polygon(square(o,1)) style\n        , (o+vector(0,0.5)) label(name,deg(180)) size(w)\n        ]\n      ) \n    , d\n    , zip([\"A\",\"B\",\"C\"],[style_a,style_b,style_c],[0,1,2])\n    )\n  , map(\n      let(\n        x,cw*j\n      , o1,origin+vector(x,0)\n      , o2, o1+vector(w+gap,0)\n      , o3, o2+vector(w+gap,0)\n      , [a,b,c,year], data[j]\n      , [ \n          polygon(rectangle(o1,o1+vector(w,0),a)) style_a\n        , (o1+vector(w/2,a)) label(a+\"\",deg(90)) size(2)\n\n        , polygon(rectangle(o2,o2+vector(w,0),b)) style_b\n        , (o2+vector(w/2,b)) label(b+\"\",deg(90)) size(2)\n\n        , polygon(rectangle(o3,o3+vector(w,0),c)) style_c\n        , (o3+vector(w/2,c)) label(c+\"\",deg(90)) size(2)\n\n        , (o1+vector((2w+gap)/2,-0.2)) label(year+\"\", deg(-90)) size(w)\n        ]\n      )\n    , j\n    , 0..len(data)-1\n    )\n  , (origin+vector(0,-0.2)..origin+vector(cw*len(data),-0.2)) arrow size(3)\n  ]\n)\n, sn\n, 0..len(schemes)-1\n)))\n");
    show_diagram("\n// Based on https://twitter.com/Cshearer41/status/1115917680027021312\neukleides(\"Catriona Shearer puzzle\",[\nlet(\n  [a,b,c],equilateral(30)\n, [c,b,d],equilateral(c,b)\n, [d,b,f],equilateral(d,b)\n, a1, b+2/3*(c-b)\n, a2, a+1/2*(b-a)\n, b1, b+3/4*(d-b)\n, b2, b+2/3*(c-b)\n, b3, b+1/2*(b1-b)\n, c1, b+4/5*(f-b)\n, c2, b+3/4*(d-b)\n, c3, b+2/3*(c1-b)\n, c4, b+1/2*(c2-b)\n, [\n    a..b..c\n  , b..c..d\n  , d..b..f\n  , (a..a1..a2) color1 open\n  , (c..b1..b2..b3) color2 open\n  , (d..c1..c2..c3..c4) color3 open\n  , ((c..d)+vector(0,2)) arrows size(10) label(\"30\")\n  , ((c3..a2)+vector(0,-2)) arrows size(10) label(\"?\")\n  ] * size(20) font(\"sans\")\n)\n])\n");
    show_diagram("\n// from https://twitter.com/Cshearer41/status/1116736986507882498\neukleides(\"The diagonal of the square has been divided into three sections of length 4. What's the shaded area?\",\nlet(\n w,6sqrt(2)\n,[a,b,c,d],square(w)\n,p1,d+(b-d)/3\n,p2,d+(b-d)*2/3\n,e2,intersection(line(a,p2),b..c)[0]\n,e1,intersection(line(e2,p1),a..d)[0]\n,[\n  (d..p1) label(\"4\") size(2)\n ,(p2..p1) label(\"4\") size(2)\n ,(p2..b) label(\"4\") size(2)\n ,[(d..e1..p1)\n  ,(p1..e2..p2)\n  ,(a..p2..b)\n  ] * filled color3\n ,(d..b) size(4) color2\n ,(e1..e2..a) size(4) color4 open\n ,(a..b..c..d) size(4)\n ]\n)\n,[\"y\":7]\n)\n");
    show_diagram("\n// https://twitter.com/Cshearer41/status/1114798315504308224\neukleides(\"The equilateral triangle in the corner of this square is tangent to the circle where they touch. What\u2019s the diameter?\",let(\n w,15\n,[a,b,c],equilateral(w)\n,d,point(r,deg(60+90))+(c-origin)\n,s,y(d)+r\n,[s1,s2,s3,s4],square(b,s,deg(90))\n,[\n  (s1..s2..s3..s4) size(15) color3\n ,circle(d,r) size(15) color2\n ,(a..b..c) color1 size(15)\n ,((d-vector(r,0))..(d+vector(r,0))) arrows size(9) label(\"?\") color4\n ,((b..a)-vector(0,1.5)) arrows size(9) label(w) color4\n ]\n),[\"r\":15])\n");
    show_diagram("\n// based on https://twitter.com/panlepan/status/1101789897902436353\neukleides(\"Three 6\xD73 rectangles overlap. Is this triangle a 3-4-5?\",let(\n [a1,a2,a3,a4],rectangle(origin,point(6,0),3)\n,[b1,b2,b3,b4],(a1..a2..a3..a4)+vector(3,3)\n,[c1,c2,c3,c4],rectangle(a2,3,6,rad(arctan(3/6)*2))\n,p,intersection(b1..b2,c2..c3)[0]\n,ma,midpoint(a1..a2)\n,mb,midpoint(b3..b4)\n,[\n  (a1..a2..a3..a4) filled color1 transparent\n ,(b1..b2..b3..b4) filled color1 transparent\n ,(c1..c2..c3..c4) filled color1 transparent\n ,(ma..b1) dashed color2 size(2)\n ,(mb..a3) dashed color2 size(2)\n ,(a1..a2..a3..a4) color2 size(4)\n ,(b1..b2..b3..b4) color2 size(4)\n ,(c1..c2..c3..c4) color2 size(4)\n ,(p..b1..b4) color4 size(6)\n ]\n))\n");
    show_diagram("\n// based on https://twitter.com/panlepan/status/1101103820598362112\neukleides(\"What fraction of the semi-circle does the pink square represent ? Is it more or less than a half?\",let(\n theta,arccos(0.5)\n,r,sqrt(5)/2\n,[\n  arc(circle(origin,r),deg(0),deg(180)) filled color1\n ,(polygon(square(1))-vector(0.5,0)) filled color2\n ,[\n   arc(circle(origin,r),deg(0),deg(180))\n  ,point(-r,0)..point(r,0)\n ]\n ]\n))\n");
    show_diagram("\n// based on https://twitter.com/panlepan/status/1097644438455750656\neukleides(\"What is the missing area?\",let(\n show_hint,false\n,l1,4\n,l2,2.5\n,an,deg(raw_an)\n,v1,vector(l1,0)\n,v2,point(l2,an)-origin\n,a,origin\n,b,a+v1\n,c,a+2v1\n,d,c+v2\n,f,c+2v2\n,g,f-v1\n,h,a+2v2\n,j,a+v2\n,p,point(x,y)\n\n,[\n  (a..b..p..j) filled opacity(0.2) color1\n ,(b..c..d..p) filled opacity(0.2) color2\n ,(d..f..g..p) filled opacity(0.2) color3\n ,(g..h..j..p) filled opacity(0.2) color4\n ,[\n   (a..b) double\n  ,(b..c) double\n  ,(f..g) double\n  ,(g..h) double\n  ,(a..j) simple\n  ,(j..h) simple\n  ,(c..d) simple\n  ,(d..f) simple\n ]\n ,([b..p, d..p, g..p, j..p]) size(2)\n ,center(a..b..p..j) text(\"27\") color1\n ,center(b..c..d..j) text(\"?\") color2\n ,center(d..f..g..p) text(\"53\") color3\n ,center(g..h..j..p) text(\"35\") color4\n\n ,if(show_hint,\n   [\n     (p..h)\n    ,(p..a)\n    ,(p..f)\n    ,(p..c)\n    ,center(a..p..j) text(\"A\")\n    ,center(h..p..j) text(\"A\")\n    ,center(a..p..b) text(\"B\")\n    ,center(b..p..c) text(\"B\") \n    ,center(c..p..d) text(\"C\")\n    ,center(d..p..f) text(\"C\")\n    ,center(f..p..g) text(\"D\")\n    ,center(g..p..h) text(\"D\") \n   ]\n  ,[]\n  )\n ,p draggable()\n ,f draggable()\n ]\n),[\"x\":2.5,\"y\":2,\"raw_an\":60])\n");
    show_diagram("\neukleides(\"Constructing an angle bisector\",let(\n ana,deg(30)\n,anb,deg(-30)\n,r,1\n,r2,r\n,a,point(r,ana)\n,b,point(r,anb)\n,p,intersection(circle(a,r2),circle(b,r2))[0]\n,incidental, dashed gray transparent\n,new,size(2) color2\n,w,3.5\n,h,1\n,steps,[\n  [\n   origin..point(2r,ana)\n  ,origin..point(2r,anb)\n ]\n ,[\n   origin..point(2r,ana)\n  ,origin..point(2r,anb)\n  ,circle(origin,r) incidental\n  ,arc(circle(origin,r),ana-deg(5),ana+deg(5)) new\n  ,arc(circle(origin,r),anb-deg(5),anb+deg(5)) new\n  ]\n ,[\n   origin..point(2r,ana)\n  ,origin..point(2r,anb)\n  ,circle(a,r2) incidental\n  ,arc(circle(origin,r),ana-deg(5),ana+deg(5))\n  ,arc(circle(origin,r),anb-deg(5),anb+deg(5))\n  ,arc(circle(a,r2),-ana-deg(5),-ana+deg(5)) new\n  ]\n ,[\n   origin..point(2r,ana)\n  ,origin..point(2r,anb)\n  ,circle(b,r2) incidental\n  ,arc(circle(origin,r),ana-deg(5),ana+deg(5))\n  ,arc(circle(origin,r),anb-deg(5),anb+deg(5))\n  ,arc(circle(a,r2),-ana-deg(5),-ana+deg(5))\n  ,arc(circle(b,r2),-anb-deg(5),-anb+deg(5)) new\n  ]\n ,[\n   origin..point(2r,ana)\n  ,origin..point(2r,anb)\n  ,arc(circle(origin,r),ana-deg(5),ana+deg(5))\n  ,arc(circle(origin,r),anb-deg(5),anb+deg(5))\n  ,arc(circle(a,r),-ana-deg(5),-ana+deg(5))\n  ,arc(circle(b,r),-anb-deg(5),-anb+deg(5))\n  ,origin..(origin+1.2(p-origin)) new\n  ]\n ,[\n   origin..point(2r,ana)\n  ,origin..point(2r,anb)\n  ,origin..(origin+1.2(p-origin))\n  ,angle(p,origin,a) simple dashed\n  ,angle(b,origin,p) simple dashed\n  ]\n ]\n,map(\n  map(x+vector(w*mod(j,3),-h*(j-mod(j,3))),x,steps[j])\n ,j\n ,0..len(steps)-1\n )\n))\n");
    show_diagram("\neukleides(\"Constructing an angle bisector animation\",-0.5,-1.5,2.5,1.5,let(\n ana,deg(30)\n,anb,deg(-30)\n,r,1\n,r2,r\n,a,point(r,ana)\n,b,point(r,anb)\n,p,intersection(circle(a,r2),circle(b,r2))[0]\n,speed,1.5\n,st,mod(time/speed,6)\n,t,floor(st)\n,dt,st-t\n,b1,0.6\n,b2,0.8\n,op,switch(\n  dt<b1,dt/b1\n ,dt<b2,1\n ,(1-dt)/(1-b2)\n )\n,incidental, dashed gray opacity(op)\n,new,size(2) color2 opacity(op)\n,added,opacity(if(dt>b2,1,0))\n,fadein,opacity(if(dt<b1,dt/b1,1))\n,w,3.5\n,h,1\n,steps,[\n  [\n   origin..point(2r,ana)\n  ,origin..point(2r,anb)\n ]\n ,[\n   origin..point(2r,ana)\n  ,origin..point(2r,anb)\n  ,circle(origin,r) incidental\n  ,arc(circle(origin,r),ana-deg(5),ana+deg(5)) added\n  ,arc(circle(origin,r),anb-deg(5),anb+deg(5)) added\n  ,arc(circle(origin,r),ana-deg(5),ana+deg(5)) new\n  ,arc(circle(origin,r),anb-deg(5),anb+deg(5)) new\n  ]\n ,[\n   origin..point(2r,ana)\n  ,origin..point(2r,anb)\n  ,circle(a,r2) incidental\n  ,arc(circle(origin,r),ana-deg(5),ana+deg(5))\n  ,arc(circle(origin,r),anb-deg(5),anb+deg(5))\n  ,arc(circle(a,r2),-ana-deg(5),-ana+deg(5)) added\n  ,arc(circle(a,r2),-ana-deg(5),-ana+deg(5)) new\n  ]\n ,[\n   origin..point(2r,ana)\n  ,origin..point(2r,anb)\n  ,circle(b,r2) incidental\n  ,arc(circle(origin,r),ana-deg(5),ana+deg(5))\n  ,arc(circle(origin,r),anb-deg(5),anb+deg(5))\n  ,arc(circle(a,r2),-ana-deg(5),-ana+deg(5))\n  ,arc(circle(b,r2),-anb-deg(5),-anb+deg(5)) added\n  ,arc(circle(b,r2),-anb-deg(5),-anb+deg(5)) new\n  ]\n ,[\n   origin..point(2r,ana)\n  ,origin..point(2r,anb)\n  ,arc(circle(origin,r),ana-deg(5),ana+deg(5))\n  ,arc(circle(origin,r),anb-deg(5),anb+deg(5))\n  ,arc(circle(a,r),-ana-deg(5),-ana+deg(5))\n  ,arc(circle(b,r),-anb-deg(5),-anb+deg(5))\n  ,origin..(origin+1.2(p-origin)) added\n  ,origin..(origin+1.2(p-origin)) new\n  ]\n ,[\n   origin..point(2r,ana)\n  ,origin..point(2r,anb)\n  ,origin..(origin+1.2(p-origin))\n  ,angle(p,origin,a) simple dashed fadein\n  ,angle(b,origin,p) simple dashed fadein\n  ]\n ]\n,[\n  group(steps[t]) opacity(1)\n ]\n))\n");
    show_diagram("\neukleides(\"Mouse input and animation demo\",\n-2,-2,5,2,[\n  let(theta,argument(vector(mousex,mousey)),\n      circ,circle(origin,1),\n      a,point(circ,theta),\n      b,point(circ,theta+deg(120)),\n      c,point(circ,theta+deg(240)),\n      [a..b..c, circle(a,b,c), a label(\"Mouse\",theta)]\n  ),\n  let(\n    t, 5*time,\n    hours, t,\n    seconds, 60*t,\n    centre, vector(3,0),\n    O, origin+centre,\n    h1, point(0.5,deg(90-hours))+centre,\n    h2, point(0.7,deg(90-seconds))+centre,\n    [\n      circle(O,1),\n      O..h1,\n      O..h2\n    ]\n  )\n])\n");
    show_diagram("\neukleides(\"Variable speed animation\",-5,-1,5,5,\n[let(\na,point(xa,ya),\nb,point(xb,yb),\nv,b-a,\nd,len(v),\nt,mod(time,1/speed)*speed,\nc,a+t*(b-a),\n[\n([\n  point(-2,4.1)..point(-2,3.9),\n  point(-2,4)..point(2,4),\n  point(2,4.1)..point(2,3.9)\n]) gray,\npoint(-2,4) label(\"Speed\",deg(180)),\npoint(clamp(5*speed,1,5)-3,4) draggable() gray,\n(a..c) dotted arrow,\na draggable(),b draggable()\n]\n)],[\"xa\":-3,\"xb\":3,\"yb\":2,\"speed\":0.5])\n");
    show_diagram("\neukleides(\"Complete graph\",-2.5,-2.5,2.5,2.5,\n[\nlet(\nsides,round(min(15,360/an)),\nstep,360/sides,\npoints,map(point(2,deg(x)),x,0..360#step),\n[\n  circle(origin,2) dashed lightgray\n, map(point(2,deg(360/n)),n,2..15) gray\n, points\n, map(a..b,[a,b],combinations(points,2))\n, point(2,deg(clamp(an,1,180))) draggable(\"P\")\n]\n)\n],[\"an\":45,\"step\":90])\n");
    show_diagram("eukleides(\"Different point types\",[\n    (point(1,0)..point(2,0)..point(2,1)..point(1,1)) filled color1,\n    point(1,0),\n    point(2,0) disc,\n    point(1,1) box,\n    point(2,1) plus,\n    point(1.5,0.5) cross\n])");
    show_diagram("eukleides(\"Line marks\",[\n    (point(0,0)..point(3,3)) label() simple,\n    (point(2,0)..point(4,3)) label() double,\n    (point(4,0)..point(5,3)) label() triple\n])");
    show_diagram("eukleides(\"Angle marks\",[\n    let(a,point(1,0), b,point(0,0), c,point(1,1),\n       [a..b,b..c,angle(a,b,c)]\n    ),\n    let(a,point(2,0), b,point(1,0), c,point(2,1),\n       [a..b,b..c,angle(a,b,c) double]\n    ),\n    let(a,point(3,0), b,point(2,0), c,point(3,1),\n       [a..b,b..c,angle(a,b,c) triple]\n    ),\n    let(a,point(1,1), b,point(0,1), c,point(1,2),\n       [a..b,b..c,angle(a,b,c) dashed]\n    ),\n    let(a,point(2,1), b,point(1,1), c,point(2,2),\n       [a..b,b..c,angle(a,b,c) double dashed]\n    ),\n    let(a,point(3,1), b,point(2,1), c,point(3,2),\n       [a..b,b..c,angle(a,b,c) triple dashed]\n    ),\n    let(a,point(1,2), b,point(0,2), c,point(1,3),\n       [a..b,b..c,angle(a,b,c) dotted]\n    ),\n    let(a,point(2,2), b,point(1,2), c,point(2,3),\n       [a..b,b..c,angle(a,b,c) double dotted]\n    ),\n    let(a,point(3,2), b,point(2,2), c,point(3,3),\n       [a..b,b..c,angle(a,b,c) triple dotted]\n    ),\n    let(a,point(3,1), b,point(3,0), c,point(4,0),\n       [a..b,b..c,angle(a,b,c) right]\n    ),\n    let(a,point(3,2), b,point(3,1), c,point(4,1),\n       [a..b,b..c,angle(a,b,c) right dotted]\n    ),\n    let(a,point(5,0), b,point(4,0), c,point(5,1),\n       [a..b,b..c,angle(a,b,c) forth]\n    ),\n    let(a,point(5,1), b,point(4,1), c,point(5,2),\n       [a..b,b..c,angle(a,b,c) back]\n    )\n])");
    show_diagram("eukleides(\"Pretty much everything!\",[\n    point(0,2.5) disc label(\"A\",deg(90)), \n    point(1,2.5) dot, \n    point(2,2.5) cross, \n    point(3,2.5) box, \n    point(4,2.5) plus,\n    (point(0,0) .. point(2,3) .. point(4,0)) arrows,\n    (point(0,1) .. point(2,4) .. point(4,1)),\n    (point(0,-1) .. point(2,2) .. point(4,-1)) filled transparent,\n    let(l1,line(point(-5,2), point(3,4)),\n        l2,line(point(8,0),point(-2,10)),\n        [l1,l2,intersection(l1,l2) label(\"I\",deg(90))]\n    ),\n    let(p,projection(point(0,0),line(point(-5,2), point(3,4))),\n        [p, (point(0,0)..p) dashed]\n    ),\n    let(p,projection(point(0,2),line(point(-5,2), point(3,4)), line(point(0,0),point(1,1))),\n        [p, line(point(0,2),point(1,3)) dashed]\n    ),\n    (line(point(-5,2), point(3,4)) + vector(0,-1)) dashed color1,\n    (line(point(-5,2), point(3,4)) + vector(0,-2)) dotted,\n    point(0,0),\n    (line(point(0,0), point(3,2))) half,\n    (line(point(0,0), point(3,2))+vector(0,-0.5)) half back dotted color2 size(3),\n    circle(point(1,3),4),\n    circle(point(1,3),3) dotted,\n    circle(point(1,3),2) dashed size(2) color3,\n    conic(point(2,2),point(3,3),1.5),\n    arc(conic(point(2,4), point(2,5), 0.2),rad(0),rad(pi)) color4 size(3),\n    arc(circle(point(0,0),2),rad(0),rad(pi/2)) hsla(240,0.8,0.8,0.5) size(5) arrow,\n    arc(circle(point(0,0),1),rad(0),rad(pi/2)) rgba(255,0,0,0.7) size(1) arrows,\n    let(l,line(point(0,0),point(5,1)),\n        p,polygon(5,point(3,0),1,rad(0)),\n        c,circle(point(5,0.5),1),\n        el,conic(point(7,1),point(7,1.5),0.7),\n        [\n            l,\n            p color2,\n            intersection(l,p) size(3),\n            c,\n            intersection(l,c) size(3),\n            el,\n            intersection(l,el) size(3)\n        ]\n    ),\n    let(\n        p1,polygon(5,point(-1,5),1,rad(0)),\n        p2,polygon(6,point(0,5),1,rad(0)),\n        c1,circle(point(1.5,5),1),\n        c2,circle(point(2.5,4.7),0.5),\n        [\n            p1,\n            p2,\n            list(intersection(p1,p2)),\n            c1,\n            c2,\n            list(intersection(c1,c2)) color1,\n            list(intersection(p2,c1))\n        ]\n    )\n])");
  });
};

